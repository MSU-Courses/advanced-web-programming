# Введение в API

## Аналогия с жизнью

Прежде чем рассмотреть, что такое API в программировании, давайте рассмотрим пример из реальной жизни.

Представьте, что вы пришли в ресторан. Вы открываете меню, выбираете блюдо – допустим, фуа-гра с трюфелями. Подходит официант, вы делаете заказ, и он уходит на кухню. Там повар готовит ваше блюдо и передает его обратно официанту, который приносит его к вашему столику. Ситуация обычная и понятная.

_А теперь задайтесь вопросом_: вы знаете, что именно происходит на кухне? Как повар готовит еду? Какие процессы и технологии он использует? Скорее всего — нет. Вы просто сделали заказ и получили результат. А повар знает, кто вы такой и зачем вам эта фуа-гра? Тоже нет. Он просто получил указание от официанта, и выполнил его.

Обратите внимание: **вы и повар фактически взаимодействовали не напрямую, а через посредника – официанта**. Вам, как клиенту, не нужно знать, что происходит на кухне и как именно повар готовит фуа-гру. Достаточно уметь правильно сделать заказ официанту. Со своей стороны, повар не обязан знать подробности о вас – ему достаточно получить от официанта понятный заказ и исполнить его. Вы получили результат (готовое блюдо), даже не заглядывая на кухню, а повар приготовил его, не общаясь с вами лично.

Эта простая аналогия хорошо иллюстрирует роль API. В нашем примере ресторанного сервиса официант выступает в роли посредника, который принимает запросы от клиента и возвращает результаты от исполнителя. Подобно этому, **API (Application Programming Interface)** – это интерфейс, посредник между двумя программами или компонентами, который принимает запросы и возвращает ответы. Например, посетитель ресторана (пользователь) делает заказ официанту (API), а кухня (сервер) его выполняет [^1]. Клиенту не нужно знать, как устроена кухня, а повару не важно, кто клиент – достаточно стандартизованного взаимодействия через “интерфейс” (официанта).

## Что такое API в программировании?

Аббревиатура **API** расшифровывается как _Application Programming Interface_, то есть «программный интерфейс приложения». Под API понимается набор правил и способов, с помощью которых одна программа может взаимодействовать с другой. Проще говоря, API скрывает внутреннюю реализацию одного компонента и предоставляет другим компонентам определенный набор функций или методов для общения [^1]. API выступает как контракт: если вы посылаете запрос определенного вида, то получите оговоренный ответ определенного формата.

В программировании API может принимать разные формы. Например:

- **API операционной системы**. Функции, через которые программы взаимодействуют с ОС (_например_, функции для работы с файлами, сетью и т.д.).
- **API библиотек и фреймворков**. Публичные методы/функции, которые предоставляет библиотека, чтобы разработчик мог выполнять определенные задачи, не вникая в реализацию.
- **Веб-API (Web API)**. Интерфейсы для взаимодействия между веб-сервисами (_о них далее_). Они позволяют приложениям обмениваться.

### Пример минималистичного API: обмен данными через файл

Рассмотрим наглядный, пусть и примитивный, пример реализации API во взаимодействии между двумя независимыми программами.

Представим, что есть два приложения:

- **Приложение A** — отвечает за создание пользователей. _Разработано на языке PHP_.
- **Приложение B** — занимается отправкой электронных писем созданным пользователям. _Реализовано на C++_.

Цель у них общая — работать с пользователями. Однако, так как они написаны на разных языках и, возможно, развиваются разными командами, они не могут напрямую вызывать функции друг друга. Им требуется способ обмена данными — то есть, необходим _интерфейс взаимодействия_.

Одним из простейших способов организации такого взаимодействия является использование общего файла. Допустим, это текстовый файл `users.txt`.

- **Приложение A** записывает в файл данные новых пользователей.
- **Приложение B** периодически читает этот файл и, на основе его содержимого, отправляет письма соответствующим адресатам.

Одним из примитивных, но наглядных способов организации взаимодействия между приложениями является обмен через файл.

- Приложение `A` записывает пользователей в файл `users.txt`,
- Приложение `B` периодически читает этот файл и, основываясь на его содержимом, отправляет письма пользователям.

Эти два приложения никак напрямую не связаны и ничего не знают о внутреннем устройстве друг друга. Однако они оба умеют работать с одним и тем же ресурсом — файлом users.txt. Это и есть их точка соприкосновения, их интерфейс взаимодействия.

Таким образом, эти два приложения взаимодействуют **опосредованно** — не напрямую, а через внешний ресурс, с которым оба умеют работать. Таким ресурсом выступает файл, а сам механизм взаимодействия — это и есть **простейшая форма API**.

В данном случае API реализован в виде файлового обмена, где:

- Файл `users.txt` выступает в роли канала передачи данных.
- Структура и формат содержимого файла являются частью "контракта", то есть самого API.

Такой API включает в себя следующие ключевые элементы:

- **Определённый формат данных**: значения записаны в формате CSV — разделены запятыми, первая строка содержит заголовки.
- **Строгие соглашения между приложениями**:
  - Каждая строка представляет одного пользователя.
  - Порядок полей должен строго соблюдаться.
  - Значения не должны содержать "сырых" запятых без экранирования.
  - Файл должен иметь определённую кодировку (например, UTF-8).
  - Пустые строки игнорируются или обрабатываются определённым образом.

Несмотря на кажущуюся «кустарность» такого решения, перед нами полноценный интерфейс взаимодействия между программами, пусть и без сетевых запросов или объектов. Такой способ можно назвать низкоуровневым API, в котором «вызов функции» заменён записью строки в файл, а «ответ» — чтением строки из этого файла другим приложением.

Нарушение соглашений приведёт к сбою или недопониманию между программами. Поэтому такие контракты на уровне формата и структуры данных — основа любого API, вне зависимости от его формы.

**Главная идея**: API предоставляет абстракцию. Разработчику не нужно разбираться во всех деталях внутреннего кода или устройства системы – достаточно вызывать функции API по заданным правилам.

## Веб-сервисы и веб-приложения

После знакомства с понятием API важно понять, как оно используется в реальных проектах — особенно в контексте веба. Здесь часто говорят о двух связанных, но разных вещах: _веб-приложения_ и _веб-сервисы_ (веб-службы).

- **Веб-приложение** – это программа, с которой напрямую взаимодействует человек. Это может быть интернет-магазин, образовательная платформа, банковское приложение и т.д. Оно включает интерфейс (UI): страницы, кнопки, формы и другие элементы пользовательского взаимодействия.
- **Веб-сервис** — это часть системы, предназначенная для программного взаимодействия, а не для работы с человеком. Это своего рода «невидимый» компонент, к которому обращаются другие программы (например, мобильные приложения или другие веб-сервисы), чтобы получить или изменить данные. Веб-сервисы предоставляют доступ к функциональности через API [^2].

Взаимодействие между веб-приложением и веб-сервисом происходит чаще всего по протоколу HTTP. Программа (_например_, веб-приложение) отправляет HTTP-запрос к определённому адресу, а веб-сервис отвечает на него, возвращая нужные данные в структурированном формате, чаще всего _JSON_.

Например, запрос к веб-сервису прогноза погоды может вернуть такой JSON:

```json
{
  "city": "Chisinau",
  "temperature": 21.3,
  "unit": "C",
  "condition": "Sunny"
}
```

Это не страница с оформлением, а «сырые» данные, которые программа может интерпретировать и отобразить так, как нужно — например, показать пользователю "Температура: 21°C".

Чтобы лучше понять, как веб-приложения и веб-сервисы работают вместе, рассмотрим простой и наглядный пример.

Представим веб-приложение — _интернет-магазин_. Пользователь заходит на сайт, чтобы просмотреть товары. Сам сайт содержит пользовательский интерфейс: кнопки, фильтры, карточки товара. Однако все данные — список товаров, цены, наличие на складе — поступают с сервера по запросу. Этот сервер — и есть веб-сервис, отвечающий за обработку запросов и взаимодействие с базой данных.

**Пример запроса**:

Интерфейс интернет-магазина делает HTTP-запрос, а веб-сервис отвечает массивом товаров в формате JSON. Приложение получает данные и отображает их пользователю в виде карточек.

В более сложных сценариях может происходить цепочка взаимодействий между несколькими веб-сервисами. Например:

1. Веб-сервис "Погода" предоставляет данные о температуре и осадках.
2. Веб-сервис "Туризм" использует эти данные для расчёта оптимальных маршрутов.
3. Веб-приложение "Туризм" обращается к сервису "Туризм", чтобы получить готовые маршруты и отобразить их пользователю.

В этом случае взаимодействие можно представить в виде цепочки: `веб-сервис "Погода" → веб-сервис "Туризм" → веб-приложение "Туризм"`.

Веб-сервисы часто называют _«бэкэндом без фронтенда_. Они принимают запросы от других программ и возвращают структурированные ответы. Главное отличие от обычных сайтов в том, что веб-сервис не выдает HTML-страницы, а передаёт данные в удобном для машин обработки формате — чаще всего _JSON_ или _XML_.

Теперь, когда понятно, как работают веб-сервисы, стоит разобраться, зачем они вообще нужны. Почему нельзя просто сделать «монолитный» сайт, где всё сразу работает? На самом деле, веб-сервисы решают сразу несколько ключевых задач:

- **Обмен данными между различными системами**. Веб-сервисы позволяют одному приложению получать данные или функциональность от другого. _Например_, приложение может через API получать курсы валют у внешнего сервиса, вместо того чтобы содержать свою базу курсов.
- **Многообразие клиентов**. Отделив серверную часть как веб-сервис, вы можете обслуживать сразу несколько типов клиентов – веб-браузеры, мобильные приложения, программы-партнеры. Все они будут использовать один и тот же сервис через API. _Например_, единственный серверный веб-сервис социальной сети может отдавать данные и веб-версии, и мобильному приложению – в разных формах, но через один API.
- **Разделение фронтенда и бекенда**. Современная тенденция – создавать одностраничные приложения (SPA) или мобильные приложения, которые полностью отделены от сервера. Сервер предоставляет только веб-сервис, а весь интерфейс и логика на клиенте. Это даёт независимость разработки: фронтенд-разработчики и бекенд-разработчики работают автономно через согласованный API.
- **Интеграция с внешними партнерами или публичные API**. Многие компании предоставляют открытые веб-сервисы (публичные API), чтобы сторонние разработчики могли строить новые приложения вокруг их данных и возможностей. _Например_, карты Google (Google Maps API) – это веб-сервис, позволяющий встраивать карты и маршруты в свои приложения.

> [!NOTE]
> Важно заметить, что _все веб-сервисы являются веб-приложениями, но не все веб-приложения являются веб-сервисами_. Под капотом веб-сервис – это тоже приложение на сервере, просто предназначенное для программного доступа.

Несмотря на то что веб-сервисы взаимодействуют через HTTP, этого само по себе недостаточно для построения эффективной системы. Если каждый сервис будет использовать собственные соглашения об именах, форматах и структуре запросов, это приведёт к хаосу, трудностям в интеграции и ошибкам в коммуникации между компонентами.

Именно поэтому были разработаны архитектурные стандарты, которые регламентируют, как правильно строить API. Один из самых популярных и широко применяемых подходов — это **REST** (Representational State Transfer).Он задаёт простые, но строгие правила, благодаря которым взаимодействие между веб-приложениями и сервисами становится предсказуемым, масштабируемым и легко поддерживаемым.

[^1]: _Что такое API простыми словами_. education.yandex.ru [online resource]. URL: https://education.yandex.ru/journal/chto-takoe-api
[^2]: _Чем различаются веб-сервис, веб-приложение и сайт_. polygant [online resource]. URL: https://polygant.net/ru/blog/chem-otlichayutsya-veb-servis-veb-prilozhenie-i-sajt/
