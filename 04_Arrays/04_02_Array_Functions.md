# Функции и операторы для работы с массивами

После создания массива вы можете выполнять с его элементами различные операции, включая их перебор, изменение и использование в шаблонах.

## Проверка на массив

Для проверки того, является ли переменная массивом, в PHP используется функция `is_array()` [^4].

**Синтаксис**:

```php
is_array(mixed $var): bool
```

- `$var` — переменная, которую нужно проверить.

**Возвращаемое значение**: `true`, если переменная является массивом, и `false` - в противном случае.

**Пример.** _Проверка переменной на массив._

```php
<?php

$fruits = ['apple', 'banana'];
$number = 42;

// Проверка переменных
var_dump(is_array($fruits)); // true
var_dump(is_array($number)); // false

```

## Получение длины массива

Для определения количества элементов в массиве используется функция `count()` [^5].

**Синтаксис**:

```php
count(array|Countable $array, int $mode = COUNT_NORMAL): int
```

- `$array` — массив, длину которого нужно получить.
- `$mode` — режим подсчета элементов.
  - `COUNT_NORMAL` (по умолчанию) — подсчитывает все элементы массива.
  - `COUNT_RECURSIVE` — подсчитывает все элементы в массиве, включая вложенные массивы.
  - и другие.

**Возвращаемое значение**: целое число, представляющее количество элементов в массиве.

**Пример.** _Получение длины массива._

```php
<?php

$fruits = ['apple', 'banana', 'orange'];

// Длина массива
echo count($fruits); // 3
```

**Пример.** _Подсчет вложенных элементов_

```php
<?php

$nestedArray = [
    'fruits' => ['apple', 'banana'],
    'vegetables' => ['carrot', 'broccoli']
];

// Обычный подсчет
echo count($nestedArray); // 2

// Рекурсивный подсчет
echo count($nestedArray, COUNT_RECURSIVE); // 6
```

> [!TIP]
> Функцию `count()` часто используют в циклах, чтобы определить количество итераций. Например, при переборе массива с помощью оператора `for`.

## Перебор элементов массива

Перебор массива позволяет получить доступ к каждому элементу и выполнить с ним определенные действия. В PHP для этой задачи можно использовать операторы `for` и `foreach`.

### Использование оператора `for`

Оператор `for` подходит для перебора индексированных массивов, где элементы имеют числовые ключи.

**Пример.** _Исользования оператора `for` для перебора элементов массива._

```php
<?php

// Создание массива
$cities = ['London', 'Paris', 'New York'];

// Перебор элементов массива
for ($i = 0; $i < count($cities); $i++) {
    echo $cities[$i] . "\n";
}
```

> [!NOTE]
> Несмотря на свою простоту, оператор `for` не является наилучшим способом перебора массивов в PHP. Вместо него рекомендуется использовать оператор `foreach`.

### Использование оператора `foreach`

Оператор `foreach` является более удобным инструментом для перебора массивов, особенно ассоциативных [^1]. Он автоматически извлекает ключи и значения.

**Синтаксис**

```php
foreach ($array as $key => $value) {
    // Работа с элементом массива
}
```

**Пример.** _Перебор индексированного массива с использованием `foreach`_

```php
<?php

// Создание массива
$cities = ['London', 'Paris', 'New York'];

// Перебор элементов массива
// $city будет принимать значение каждого элемента массива
// Сначала $city = 'London', потом $city = 'Paris', потом $city = 'New York'
foreach ($cities as $city) {
    echo $city . "\n";
}
```

**Результат выполнения кода**:

```
London
Paris
New York
```

**Пример.** _Перебор ассоциативного массива с использованием `foreach`_

```php
<?php

// Создание ассоциативного массива
$person = [
    'name' => 'John',
    'age' => 30,
    'city' => 'New York'
];

// Перебор элементов массива
// $key будет принимать ключи, а $value — значения
foreach ($person as $key => $value) {
    echo "Ключ: {$key} | Значение: {$value}\n";
}
```

**Результат выполнения кода**:

```
Ключ: name | Значение: John
Ключ: age | Значение: 30
Ключ: city | Значение: New York
```

### Создание таблицы из массива

Массивы можно использовать для генерации HTML-кода, например, для создания таблицы.

**Пример.** _Создание таблицы из ассоциативного массива._

```php
<?php

// Создание ассоциативного массива
$person = [
    'name' => 'John',
    'age' => 30,
    'city' => 'New York'
];
?>

<table border="1">
    <thead>
        <tr>
            <!-- Вывод ключей массива в качестве заголовков таблицы -->
            <?php foreach ($person as $key => $value): ?>
                <th><?= htmlspecialchars($key) ?></th>
            <?php endforeach; ?>
        </tr>
    </thead>
    <tbody>
        <tr>
            <!-- Вывод значений массива в качестве данных таблицы -->
            <?php foreach ($person as $value): ?>
                <td><?= htmlspecialchars($value) ?></td>
            <?php endforeach; ?>
        </tr>
    </tbody>
</table>
```

> [!NOTE]
> Функция `htmlspecialchars()` используется для безопасного вывода данных в HTML. Она преобразует специальные символы в HTML-сущности, что предотвращает _XSS-атаки_.

## Добавление элементов в массив

Массивы в PHP позволяют легко добавлять новые элементы.

Для добавления элементов в конец индексированного массива используются:

- оператор `[]`
- функция `array_push()` [^2]
- функция `array_unshift()` [^3]

### Добавление элементов в индексированный массив

#### Использование оператора `[]`

Самый простой способ добавить элемент в индексированный массив — использовать оператор `[]`.

Новый элемент будет добавлен в конец массива.

**Пример.** _Добавление элемента в массив с помощью оператора `[]`._

```php
<?php

$cities = ['London', 'Paris'];

// Добавление элемента в массив
$cities[] = 'New York';

print_r($cities);
```

**Результат выполнения кода**:

```
Array
(
    [0] => London
    [1] => Paris
    [2] => New York
)
```

#### Использование функции `array_push()`

Функция `array_push()` добавляет один или несколько элементов в конец массива.

> [!TIP]
> Этот способ особенно удобен, если нужно добавить сразу несколько элементов.

**Синтаксис**

```php
array_push(array $array, mixed ...$values): int
```

- `$array` — массив, в который добавляются элементы.
- `$values` — элементы, которые добавляются в массив.

**Возвращаемое значение**: количество элементов в массиве после добавления.

**Пример.** _Добавление элементов в массив с помощью функции `array_push()`._

```php
<?php

$fruits = ['apple', 'banana'];

// Добавление элементов в массив
array_push($fruits, 'orange', 'grape');

print_r($fruits);
```

**Результат выполнения кода**:

```
Array
(
    [0] => apple
    [1] => banana
    [2] => orange
    [3] => grape
)
```

> [!TIP]
> Если нужно добавить только один элемент, предпочтительнее использовать оператор [], так как он более читаем и работает быстрее.

#### Использование функции `array_unshift()`

Функция `array_unshift()` добавляет один или несколько элементов в начало массива.

**Синтаксис**

```php
array_unshift(array $array, mixed ...$values): int
```

- `$array` — массив, в который добавляются элементы.
- `$values` — элементы, которые добавляются в массив.

**Возвращаемое значение**: количество элементов в массиве после добавления.

**Пример.** _Добавление элементов в начало массива с помощью функции `array_unshift()`._

```php
<?php

$fruits = ['apple', 'banana'];

// Добавление элементов в начало массива
array_unshift($fruits, 'orange', 'grape');

print_r($fruits);
```

**Результат выполнения кода**:

```
Array
(
    [0] => orange
    [1] => grape
    [2] => apple
    [3] => banana
)
```

### Добавление элементов в ассоциативный массив

Ассоциативные массивы позволяют добавлять элементы, присваивая значение новому или существующему ключу.

**Пример.** _Добавление элементов в ассоциативный массив._

```php
<?php

$person = [
    'name' => 'John',
    'age' => 30
];

// Добавление нового элемента
$person['city'] = 'New York';

print_r($person);
```

**Результат выполнения кода**:

```
Array
(
    [name] => John
    [age] => 30
    [city] => New York
)
```

> [!IMPORTANT]
> Если ключ уже существует, его значение будет перезаписано.

## Удаление элементов из массива

В PHP для удаления элементов из массива используются функции `unset()` и `array_pop()`.

Каждая из них используется для разных сценариев.

### Удаление элемента из конца массива

Функция `array_pop()` удаляет последний элемент массива и возвращает его значение [^6].

**Синтаксис**

```php
array_pop(array &$array): mixed
```

- `$array` — массив, из которого удаляется элемент.

**Возвращаемое значение**: значение удалённого элемента или `null`, если массив пуст.

**Пример.** _Удаление последнего элемента массива._

```php
<?php

$fruits = ['apple', 'banana', 'orange'];

// Удаление последнего элемента
$lastFruit = array_pop($fruits);

print_r($fruits);
```

**Результат выполнения кода**:

```
Array
(
    [0] => apple
    [1] => banana
)
```

### Удаление элемента по ключу

Функция `unset()` удаляет элемент массива по его ключу [^7].

**Синтаксис**

```php
unset(mixed &$var, mixed ...$vars): void
```

- `$var` — переменная или элемент массива, который нужно удалить.

**Пример.** _Удаление элемента из индексированного массива._

```php
<?php

$fruits = ['apple', 'banana', 'orange'];

// Удаление элемента по ключу 1
unset($fruits[1]);

print_r($fruits);
```

**Результат выполнения кода**:

```
Array
(
    [0] => apple
    [2] => orange
)
```

> [!NOTE]
> Индексы не пересчитываются автоматически. Если это необходимо, можно использовать функцию `array_values()` для переиндексации: `$fruits = array_values($fruits);`.

**Пример.** _Удаление элемента из ассоциативного массива._

```php
<?php

$person = [
    'name' => 'John',
    'age' => 30,
    'city' => 'New York'
];

// Удаление элемента с ключом 'age'
unset($person['age']);

print_r($person);
```

**Результат выполнения кода**:

```
Array
(
    [name] => John
    [city] => New York
)
```

## Объединение массивов

Для объединения двух или более массивов в PHP используется оператор `+` или функция `array_merge()` [^8].

### Использование оператора `+`

Оператор `+` работает следующим образом:

- Если ключи массивов не пересекаются, элементы добавляются в результирующий массив.
- Если ключи пересекаются, элементы из первого массива имеют приоритет, и элементы второго массива не заменяют их.
- Порядок массивов имеет значение: сначала элементы из первого массива, затем — из второго (при условии отсутствия одинаковых ключей).

**Пример.** _Объединение массивов с использованием оператора `+`._

```php
<?php

$fruits1 = ['apple', 'banana'];

$fruits2 = ['orange', 'grape'];

// Объединение массивов
$allFruits = $fruits1 + $fruits2;

print_r($allFruits);
```

**Результат выполнения кода**:

```
Array
(
    [0] => apple
    [1] => banana
)
```

Почему в результирующем массиве только элементы из первого массива?

1. Массив $fruits1 содержит элементы с ключами `0` и `1` (`0` => 'apple', `1` => 'banana').
2. Массив $fruits2 также содержит элементы с ключами `0` и `1` (`0` => 'orange', `1` => 'grape`).
3. При объединении оператор `+` добавляет все элементы из `$fruits1` в результирующий массив.
4. Поскольку ключи пересекаются, элементы из `$fruits2` игнорируются.

Рассмотрим пример, где ключи массивов не пересекаются.

**Пример.** _Объединение ассоциативных массивов._

```php
<?php

$person1 = [
    'name' => 'John',
    'age' => 30
];

$person2 = [
    'age' => 25,
    'city' => 'New York'
];

// Объединение массивов
$person = $person1 + $person2;

print_r($person);
```

**Результат выполнения кода**:

```
Array
(
    [name] => John
    [age] => 30
    [city] => New York
)
```

- Ключ `'age'` присутствует в обоих массивах.
- Значение из `$person1` (`'age' => 30`) остаётся, а значение из `$person2` (`'age' => 25`) игнорируется.

Предположите, какой будет результат, если поменять местами массивы `$person1` и `$person2`: `$person = $person2 + $person1;`.

### Использование функции `array_merge()`

Функция `array_merge()` объединяет два или более массивов в один.

- В **индексированных массивах** элементы добавляются в порядке их передачи в функцию, а индексы пересчитываются заново.
- В **ассоциативных массивах** значения с одинаковыми ключами заменяются значениями из последнего переданного массива.

**Синтаксис**

```php
array_merge(array ...$arrays): array
```

- `$arrays` — массивы, которые нужно объединить.

**Возвращаемое значение**: новый массив, содержащий элементы из всех переданных массивов.

**Пример.** _Объединение индексированных массивов._

```php
<?php

$fruits1 = ['apple', 'banana'];
$fruits2 = ['orange', 'grape'];

// Объединение массивов
$allFruits = array_merge($fruits1, $fruits2);

print_r($allFruits);
```

**Результат выполнения кода**:

```
Array
(
    [0] => apple
    [1] => banana
    [2] => orange
    [3] => grape
)
```

**Индексы массива пересчитываются**, элементы добавляются в порядке их передачи в функцию.

**Пример.** _Объединение ассоциативных массивов._

```php
<?php

$person1 = [
    'name' => 'John',
    'age' => 30
];

$person2 = [
    'age' => 25,
    'city' => 'New York'
];

// Объединение массивов
$person = array_merge($person1, $person2);

print_r($person);
```

**Результат выполнения кода**:

```
Array
(
    [name] => John
    [age] => 25
    [city] => New York
)
```

Значение `'age'` из `$person2` (`25`) заменяет значение из `$person1` (`30`).

> [!TIP]
> Функция `array_merge()` полезна, когда нужно объединить массивы с перезаписью ключей или пересчётом индексов. Для сохранения ключей используйте оператор `+`.

## Поиск элементов в массиве

Для поиска элементов в массиве в PHP используются функции `in_array()` и `array_search()`.

### Поиск значения в массиве

Функция `in_array()` проверяет, содержится ли указанное значение в массиве [^9].

**Синтаксис**

```php
in_array(mixed $needle, array $haystack, bool $strict = false): bool
```

- `$needle` — значение, которое нужно найти.
- `$haystack` — массив, в котором производится поиск.
- `$strict` — флаг строгого сравнения (`true` для проверки типа).

**Возвращаемое значение**: `true`, если значение найдено, и `false` - если значение не найдено.

**Пример.** _Поиск значения в массиве._

```php
<?php

$cars = ['BMW', 'Audi', 'Mercedes'];

// Поиск значения
var_dump(in_array('Audi', $cars)); // true
var_dump(in_array('Toyota', $cars)); // false
```

### Поиск ключа по значению

Функция `array_search()` возвращает ключ элемента массива, если значение найдено [^10].

**Синтаксис**

```php
array_search(mixed $needle, array $haystack, bool $strict = false): mixed
```

- `$needle` — значение, которое нужно найти.
- `$haystack` — массив, в котором производится поиск.
- `$strict` — флаг строгого сравнения (`true` для проверки типа).

**Возвращаемое значение**: ключ элемента, если значение найдено, и `false` - если значение не найдено.

**Пример.** _Поиск ключа по значению в массиве._

```php
<?php

$cars = ['BMW', 'Audi', 'Mercedes'];

// Поиск ключа
$key = array_search('Audi', $cars);

echo $key; // 1
```

### Поиск в ассоциативном массиве

Для поиска значения в ассоциативных массивах можно использовать функцию `array_search()`, которая возвращает ключ, соответствующий найденному значению.

**Пример.** _Поиск ключа по значению в ассоциативном массиве._

```php
<?php

$person = [
    'name' => 'John',
    'age' => 30,
    'city' => 'New York'
];

// Поиск ключа по значению
$key = array_search('New York', $person);

echo $key; // city
```

При работе с многомерными массивами полезна функция `array_column()` [^11], которая позволяет извлечь значения определённого ключа из массива. Это удобно для поиска значения в столбце данных.

```php
<?php

$persons = [
    [
        'name' => 'John',
        'age' => 30,
        'city' => 'New York'
    ],
    [
        'name' => 'Alice',
        'age' => 25,
        'city' => 'London'
    ],
];

// Получение массива значений по ключу 'city': ['New York', 'London']
$cities = array_column($persons, 'city');

// Значение для поиска
$search = 'London';

// Поиск значения в массиве
$key = array_search($search, $cities);

echo $persons[$key]['name']; // Alice
```

## Удаление и замена значений в массиве

В PHP для удаления и замены значений в массиве используется функция `array_splice()`. Она позволяет удалять часть массива, заменять её новыми элементами или добавлять элементы в определённое место.

**Синтаксис**

```php
array_splice(array &$array, int $offset, int $length = 0, mixed $replacement = []): array
```

- `$array` — массив, из которого удаляются или заменяются элементы.
- `$offset` — начальный индекс для удаления или замены.
- `$length` — количество удаляемых элементов (по умолчанию `0`, что означает отсутствие удаления).
- `$replacement` — массив с элементами для замены удалённых элементов (по умолчанию пустой массив).

**Возвращаемое значение**: массив, содержащий удалённые элементы.

**Пример.** _Удаление элемента и добавление новых._

```php
<?php

$fruits = ['apple', 'banana', 'orange', 'grape'];
$toAdd = ['kiwi', 'pear'];

// Удаляем элемент по индексу 2 и добавляем новые элементы
$removed = array_splice($fruits, 2, 1, $toAdd);

print_r($fruits);
print_r($removed);
```

**Результат выполнения кода**:

```
Array ($fruits)
(
    [0] => apple
    [1] => banana
    [2] => kiwi
    [3] => pear
    [4] => grape
)

Array ($removed)
(
    [0] => orange
)

```

- Элемент `'orange'` удалён из массива `$fruits`
- Вместо него добавлены `'kiwi'` и `'pear'`

**Пример.** _Удаление с негативным смещением._

```php
<?php

<?php

$fruits = ['apple', 'banana', 'orange', 'grape'];

// Негативное смещение позволяет указывать индексы с конца массива.
// Удаляем элемент по индексу -2 (с конца массива)
$removed = array_splice($fruits, -2, 1);

print_r($fruits);
print_r($removed);
```

**Результат выполнения кода**:

```
Array ($fruits)
(
    [0] => apple
    [1] => banana
    [2] => grape
)

Array ($removed)
(
    [0] => orange
)

```

- Элемент `'orange'` (второй с конца) удалён.

**Пример.** _Добавление элементов без удаления_

```php
<?php

$fruits = ['apple', 'banana', 'grape'];

// Вставляем элементы на позицию 2
// Если длина удаления ($length) равна 0, элементы вставляются без удаления.
array_splice($fruits, 2, 0, ['kiwi', 'pear']);

print_r($fruits);
```

**Результат выполнения кода**:

```
Array
(
    [0] => apple
    [1] => banana
    [2] => kiwi
    [3] => pear
    [4] => grape
)
```

## Преобразование массивов в строки и обратно

При разработке часто возникает задача преобразования массивов в строки и наоборот — например, для передачи данных через URL, сохранения в файле или вывода.

В PHP для этого используются функции `implode()` и `explode()`.

### Преобразование массива в строку

Функция implode() объединяет элементы массива в строку, разделяя их заданным разделителем [^13].

**Синтаксис**

```php
implode(string $glue, array $pieces): string
```

- `$glue` — строка-разделитель, используемая для объединения элементов массива.
- `$pieces` — массив, элементы которого нужно объединить.

**Возвращаемое значение**: строка, содержащая элементы массива, разделённые указанным разделителем.

**Пример.** _Преобразование массива в строку._

```php
<?php

$fruits = ['apple', 'banana', 'orange'];

// Преобразование массива в строку
$fruitsString = implode(', ', $fruits);

echo $fruitsString; // apple, banana, orange
```

### Преобразование строки в массив

Функция `explode()` разбивает строку на массив, используя заданный разделитель [^14].

**Синтаксис**

```php
explode(string $delimiter, string $string, int $limit = PHP_INT_MAX): array
```

- `$delimiter` — строка, которая используется для разделения.
- `$string` — строка, которую нужно разбить на элементы массива.
- `$limit` — максимальное количество элементов в результирующем массиве. По умолчанию `PHP_INT_MAX`.

**Возвращаемое значение**: массив, содержащий элементы строки.

**Пример.** _Преобразование строки в массив._

```php
<?php

$names = 'John, Alice, Bob';

// Преобразование строки в массив
$namesArray = explode(', ', $names);

print_r($namesArray);
```

**Результат выполнения кода**:

```
Array
(
    [0] => John
    [1] => Alice
    [2] => Bob
)
```

## Функция `compact()`

Функция `compact()` в PHP позволяет создавать массивы из переменных и их значений, избегая избыточного кода и тавтологии [^15].

Рассмотрим следующую задачу: у вас есть переменные, и вам нужно создать из них массив.

Обычное решение выглядит так:

```php
<?php

$name = 'John';
$age = 30;
$city = 'New York';

$person = [
    'name' => $name,
    'age' => $age,
    'city' => $city
];
```

В этом случае приходится повторять имена переменных, что приводит к избыточности кода и снижает его читаемость.

Функция `compact()` устраняет эту проблему, автоматически создавая массив из указанных переменных и их значений.

**Синтаксис**

```php
compact(string ...$var_names): array
```

- `$var_names` — список имён переменных, которые нужно включить в массив.

**Возвращаемое значение**: массив, где ключами являются имена переменных, а значениями — их значения.

**Пример.** _Использование функции `compact()`._

```php
<?php

$name = 'John';
$age = 30;
$city = 'New York';

// Создание массива из переменных
$person = compact('name', 'age', 'city');

print_r($person);
```

**Результат выполнения кода**:

```
Array
(
    [name] => John
    [age] => 30
    [city] => New York
)
```

## Где искать остальные функции?

Рассмотреть все функции для работы с массивами в PHP в рамках одного урока невозможно.

Однако, PHP предоставляет широкий набор встроенных функций для работы с массивами, которые вы можете изучить самостоятельно.

В официальной документации PHP представлен полный список функций для работы с массивами: https://www.php.net/manual/ru/ref.array.php

[^1]: _foreach_. php.net [online resource]. Available at: https://www.php.net/manual/en/control-structures.foreach.php
[^2]: _array push_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.array-push.php
[^3]: _array unshift_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.array-unshift.php
[^4]: _is array_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.is-array.php
[^5]: _count_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.count.php
[^6]: _array pop_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.array-pop.php
[^7]: _unset_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.unset.php
[^8]: _array merge_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.array-merge.php
[^9]: _in array_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.in-array.php
[^10]: _array search_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.array-search.php
[^11]: _array column_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.array-column.php
[^12]: _array splice_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.array-splice.php
[^13]: _implode_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.implode.php
[^14]: _explode_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.explode.php
[^15]: _compact_. php.net [online resource]. Available at: https://www.php.net/manual/en/function.compact.php